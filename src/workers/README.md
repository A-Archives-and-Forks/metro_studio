# workers 目录说明

该目录存放 Web Worker 计算任务。

- `layoutWorker.js`
  - 自动排版核心算法
  - 地理锚定优先的力导向迭代（保留原地理形态，不做拓扑重排）
  - 每次排版均从 `lngLat` 重建初始坐标，避免连续多次排版导致示意图漂移
  - 地理初始坐标系放大（`geoSeedScale=2`），提高空间展开度
  - 八方向吸附 + 交汇扇出 + 交叉排斥
  - 线路长走廊直线化（连续、非换乘/非分叉站段按端点连线投影，抑制阶梯抖动）
  - 位移上限约束（限制偏离真实地理骨架）
  - 自动标签布局（返回 `layoutMeta.stationLabels`）
  - 评分函数（角度、长度、转折、短折线、重叠、交叉、地理偏差、标签冲突）
  - 返回更新后的站点布局、评分明细与 `layoutMeta`

目的：

- 将重计算从主线程移出，保持编辑交互流畅。
