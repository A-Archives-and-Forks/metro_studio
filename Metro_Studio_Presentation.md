# Metro Studio
## 专业地铁线路图编辑器

---

## 📋 项目简介

**Metro Studio** 是一个专为轨道交通爱好者和城市规划者设计的 Web 应用程序，让用户能够在真实地图上轻松绘制专业的地铁线路图。

### 核心定位
- 🎯 **目标用户**：轨道交通爱好者、城市规划者、交通设计师
- 🌐 **应用类型**：基于 Web 的单页应用（SPA）
- 📍 **在线访问**：https://metro-studio-iota.vercel.app/
- 📜 **开源协议**：GPL-3.0

### 项目数据
- ⭐ GitHub Stars: 2
- 🔀 Forks: 1
- 👥 贡献者: 2
- 📝 提交数: 55+

---

## 💡 项目灵感

### 创作动机

**1. 轨道交通爱好者的需求**
- 现有工具功能单一，缺乏真实地理位置编辑
- 专业软件（如 Illustrator）学习成本高，不够直观
- 缺少自动化布局和示意图生成功能

**2. 城市规划可视化需求**
- 需要快速展示地铁网络发展历程
- 需要专业的线路图导出功能
- 需要支持时间线动画演示

**3. 技术创新机会**
- 结合 GIS 技术与图形设计
- 利用算法自动优化线路布局
- 集成 AI 辅助命名功能

---

## 🔍 竞品分析

### 主要竞品对比

| 产品 | 类型 | 优势 | 劣势 |
|------|------|------|------|
| **Metro Map Maker** | 在线工具 | 简单易用，快速上手 | 缺少真实地图编辑，布局手动 |
| **Rail Map Toolkit** | 工具集 | 多种绘图工具，风格多样 | 功能分散，学习曲线陡峭，并且花钱 |
| **EdrawMax** | 桌面软件 | 专业模板丰富 | 付费软件，非专注地铁设计 |
| **MetroDreamin'** | 在线平台 | 社区分享功能强 | 自动化程度低，缺少导出 |
| **Adobe Illustrator** | 专业软件 | 完全控制，专业级 | 昂贵，学习成本极高 |

### Metro Studio 的差异化优势

✅ **真实地图 + 示意图双模式**
- 在 OpenStreetMap 上精确定位站点
- 自动生成八方向规整示意图

✅ **智能自动化**
- 力导向算法自动优化布局
- AI 辅助生成中英文站点名称
- 一键导入 OSM 真实数据

✅ **多视图展示**
- 地图视图、示意图视图、车载 HUD 视图、时间线视图
- 支持时间线动画导出

✅ **完全免费开源**
- GPL-3.0 协议，代码完全开放
- 无需安装，浏览器直接使用

---

## 🛠️ 开发历程

### 技术架构演进

**第一阶段：基础框架搭建**
- 选择 Vue 3 + Vite 作为开发框架
- 集成 MapLibre GL JS 实现地图渲染
- 使用 Pinia 进行状态管理

**第二阶段：核心功能开发**
- 实现站点、线路、边的增删改查
- 开发多选、框选、批量编辑功能
- 实现撤销/重做历史记录系统

**第三阶段：算法优化**
- 开发力导向布局算法（Web Worker）
- 实现约束求解和标签放置优化
- 集成 Dijkstra 最短路径算法

**第四阶段：高级功能**
- 开发示意图自动生成引擎
- 实现车载 HUD 视图模拟
- 添加时间线动画和视频导出

**第五阶段：AI 集成**
- 集成 OpenRouter API
- 实现基于地理位置的 AI 命名
- 支持批量智能命名

**第六阶段：数据持久化**
- IndexedDB 自动保存
- 项目导入/导出（ZIP 格式）
- 土地使用图层叠加

### 关键技术决策

**为什么选择 MapLibre GL JS？**
- 开源免费（Mapbox 需要付费）
- 性能优秀，支持矢量瓦片
- 社区活跃，生态完善

**为什么使用 Web Worker？**
- 布局算法计算密集，避免阻塞 UI
- 支持大规模网络（100+ 站点）
- 提升用户体验

**为什么选择 GeoJSON？**
- 标准化地理数据格式
- 与 OSM 数据无缝对接
- 易于序列化和存储

---

## ⚡ 主要功能

### 1️⃣ 地图编辑模式

**基础编辑**
- 🖱️ 点击添加站点
- 🔗 拖拽连接线路
- ✏️ 编辑站点名称（中英文）
- 🎨 自定义线路颜色和样式

**高级编辑**
- 📦 框选多个对象
- 🔄 批量修改属性
- 🎯 精确定位站点坐标
- 📏 测量工具

**线路管理**
- 🚇 创建多条线路
- 🎨 设置线路颜色、宽度、样式
- 📅 标记开通年份
- 🚧 区分运营中/在建/规划状态

### 2️⃣ 示意图自动生成

**智能布局算法**
- 🧮 力导向算法优化站点位置
- 📐 八方向规整（0°, 45°, 90°, 135°...）
- 🏷️ 智能标签放置避免重叠
- ⚖️ 约束求解保持拓扑关系

**布局控制**
- 🎚️ 调整力场强度
- 🔒 锁定关键站点位置
- 🔄 实时预览布局效果
- 💾 保存布局配置

### 3️⃣ 多视图展示

**地图视图**
- 🗺️ 真实地理位置编辑
- 🌍 OpenStreetMap 底图
- 📍 精确坐标定位

**示意图视图**
- 🎨 官方风格线路图
- 📏 规整的八方向布局
- 🖼️ 高清 PNG 导出

**车载 HUD 视图**
- 🚇 模拟地铁车厢显示屏
- 🔄 动态显示当前站和下一站
- 🎬 支持动画演示

**时间线视图**
- 📅 按年份筛选线路
- ▶️ 播放网络发展动画
- 🎥 导出时间线视频

### 4️⃣ AI 辅助功能

**智能命名**
- 🤖 基于周边地理信息生成站点名称
- 🌐 自动生成中英文双语名称
- 📦 支持批量命名
- ⚙️ 支持自定义 API（OpenAI 兼容）

**工作原理**
1. 获取站点周边 POI 数据
2. 分析地理特征和地标
3. 调用 AI 模型生成名称
4. 自动填充到站点属性

### 5️⃣ 数据导入导出

**导入功能**
- 📥 从 OpenStreetMap 导入真实数据
- 📂 导入项目文件（ZIP）
- 🔄 自动解析 OSM 线路和站点

**导出功能**
- 🖼️ 导出高清 PNG 图片
- 🎥 导出时间线动画视频
- 💾 导出项目数据（ZIP）
- 📊 导出网络统计数据

### 6️⃣ 其他功能

**导航路径规划**
- 🧭 Dijkstra 算法计算最短路径
- 🚇 显示换乘站点
- ⏱️ 估算行程时间

**样式刷工具**
- 🎨 复制线路样式
- 📦 批量应用到其他线路
- ⚡ 快速统一风格

**历史记录**
- ↩️ 撤销/重做（Ctrl+Z / Ctrl+Shift+Z）
- 💾 自动保存检查点
- 🔄 恢复到历史版本

---

## ✨ 项目亮点

### 🎯 技术亮点

**1. 复杂算法实现**
- **力导向布局算法**：基于物理模拟的自动布局，支持多种力场（弹簧力、排斥力、对齐力）
- **约束求解系统**：保证线路规整性和拓扑正确性
- **标签放置优化**：避免标签重叠，智能选择最佳位置
- **Web Worker 并行计算**：大规模网络（100+ 站点）流畅运行

**2. 性能优化**
- **IndexedDB 持久化**：自动保存，防止数据丢失
- **增量渲染**：只更新变化的部分
- **虚拟化技术**：处理大规模数据集
- **懒加载**：按需加载地图瓦片

**3. 用户体验**
- **实时预览**：所见即所得
- **快捷键支持**：提升编辑效率
- **响应式设计**：适配不同屏幕尺寸
- **自动保存**：防止意外丢失

### 🌟 功能亮点

**1. 真实地图 + 示意图双模式**
- 业界首创的双模式编辑
- 无缝切换，数据同步
- 满足不同场景需求

**2. AI 辅助命名**
- 解决命名困难问题
- 提升编辑效率 10 倍
- 支持多语言生成

**3. 时间线动画**
- 直观展示网络发展历程
- 支持视频导出分享
- 适合演示和教学

**4. 多视图展示**
- 地图、示意图、HUD、时间线
- 满足不同展示需求
- 专业级视觉效果

### 🏆 创新点

**1. 算法创新**
- 八方向规整算法
- 自适应标签放置
- 拓扑保持约束

**2. 交互创新**
- 框选批量编辑
- 样式刷工具
- Alt+点击选中整条线路

**3. 数据创新**
- OSM 数据直接导入
- GeoJSON 标准格式
- 跨平台数据共享

---

## 🚧 不足与挑战

### 当前限制

**1. 功能层面**
- ❌ 不支持曲线线路（仅支持折线）
- ❌ 示意图布局算法仍需优化（复杂网络效果不佳）
- ❌ 缺少协作编辑功能（多人同时编辑）
- ❌ 导出格式有限（不支持 SVG、PDF）
- ❌ 移动端体验不佳（主要为桌面设计）

**2. 性能层面**
- ⚠️ 超大规模网络（200+ 站点）性能下降
- ⚠️ 布局算法收敛速度慢
- ⚠️ 视频导出速度慢（纯前端实现）
- ⚠️ 内存占用较高

**3. 用户体验**
- ⚠️ 学习曲线较陡（功能复杂）
- ⚠️ 缺少新手引导教程
- ⚠️ 错误提示不够友好
- ⚠️ 部分操作不够直观

**4. 生态层面**
- 📉 用户基数小（2 stars）
- 📉 社区不够活跃
- 📉 缺少插件系统
- 📉 文档不够完善

### 技术债务

**1. 代码质量**
- 部分组件过于庞大（MapEditor.vue 1000+ 行）
- 缺少单元测试
- 类型定义不完整（部分使用 JS）

**2. 架构问题**
- 状态管理复杂度高
- 组件耦合度较高
- 缺少清晰的模块边界

---

## 🚀 未来展望

### 短期计划（1-3 个月）

**1. 功能完善**
- ✅ 支持曲线线路绘制
- ✅ 优化示意图布局算法
- ✅ 添加 SVG/PDF 导出
- ✅ 改进移动端适配

**2. 用户体验**
- ✅ 添加新手引导教程
- ✅ 优化快捷键系统
- ✅ 改进错误提示
- ✅ 添加操作历史面板

**3. 性能优化**
- ✅ 优化大规模网络渲染
- ✅ 加速布局算法收敛
- ✅ 减少内存占用
- ✅ 实现增量保存

### 中期计划（3-6 个月）

**1. 协作功能**
- 🔄 多人实时协作编辑
- 🔄 版本控制和历史记录
- 🔄 评论和标注功能
- 🔄 权限管理系统

**2. 社区建设**
- 🔄 项目分享平台
- 🔄 模板库和示例库
- 🔄 用户作品展示
- 🔄 社区论坛

**3. 插件系统**
- 🔄 开放 API 接口
- 🔄 支持第三方插件
- 🔄 自定义渲染器
- 🔄 扩展工具栏

### 长期愿景（6-12 个月）

**1. 平台化**
- 🌟 支持更多交通类型（公交、轻轨、有轨电车）
- 🌟 集成 3D 可视化
- 🌟 支持实时数据接入
- 🌟 提供 API 服务

**2. 商业化探索**
- 💼 企业版（高级功能）
- 💼 定制开发服务
- 💼 培训和咨询
- 💼 数据服务

**3. 生态拓展**
- 🌐 桌面客户端（Electron）
- 🌐 移动 App（React Native）
- 🌐 浏览器插件
- 🌐 VS Code 扩展

### 技术演进

**1. 架构升级**
- 重构为微前端架构
- 引入 TypeScript 全面覆盖
- 实现完整的测试体系
- 优化构建和部署流程

**2. 算法改进**
- 引入机器学习优化布局
- 实现更智能的标签放置
- 支持自定义约束规则
- 提供多种布局风格

**3. AI 深度集成**
- 智能线路规划建议
- 自动检测设计问题
- 风格迁移和美化
- 自然语言交互

---

## 🎓 总结

### 项目价值

**对用户的价值**
- 🎯 降低地铁线路图制作门槛
- ⚡ 大幅提升编辑效率
- 🎨 产出专业级视觉效果
- 🆓 完全免费开源

**对社区的价值**
- 📚 提供学习和参考案例
- 🤝 促进轨道交通文化传播
- 🌍 推动开源生态发展
- 💡 激发创新和创意

**技术价值**
- 🧮 复杂算法工程化实践
- 🎨 GIS + 图形设计融合
- 🚀 现代 Web 技术应用
- 🤖 AI 辅助设计探索

### 核心竞争力

1. **技术深度**：力导向布局、约束求解、路径规划等算法
2. **功能广度**：地图编辑、示意图生成、多视图展示、AI 辅助
3. **用户体验**：直观易用、实时预览、自动保存
4. **开源生态**：完全开放、社区驱动、持续迭代

### 发展潜力

- 📈 **市场需求**：轨道交通爱好者群体庞大且活跃
- 🌟 **技术创新**：算法和 AI 仍有巨大优化空间
- 🤝 **社区潜力**：开源项目易于吸引贡献者
- 💼 **商业价值**：可拓展到专业设计和咨询领域

---

## 📚 参考资料

### 竞品研究
- [Metro Map Maker](https://metromapmaker.com) - 在线地铁地图制作工具
- [Rail Map Toolkit](https://railmapgen.org) - 轨道交通地图工具集
- [EdrawMax](https://edrawsoft.com) - 专业绘图软件
- [MetroDreamin'](https://metrodreamin.com) - 交通系统设计平台

### 技术文档
- [MapLibre GL JS](https://maplibre.org) - 开源地图渲染引擎
- [Vue 3 Documentation](https://vuejs.org) - Vue.js 官方文档
- [OpenStreetMap](https://openstreetmap.org) - 开放地图数据

### 项目链接
- **GitHub**: https://github.com/Ce-daros/railmap
- **在线演示**: https://metro-studio-iota.vercel.app/
- **许可证**: GPL-3.0

---

## 🙏 致谢

感谢所有为 Metro Studio 做出贡献的开发者和用户！

**特别感谢**
- OpenStreetMap 社区提供的地图数据
- MapLibre 团队的开源地图引擎
- Vue.js 和 Pinia 团队的优秀框架
- 所有提供反馈和建议的用户

---

# Thank You!

**Metro Studio - 让地铁线路图设计更简单**

🌐 https://metro-studio-iota.vercel.app/
📧 联系方式：GitHub Issues
⭐ 欢迎 Star 和贡献代码！
